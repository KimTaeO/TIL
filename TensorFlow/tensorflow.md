# 텐서플로우

계산 그래프와 세션을 생성하지 않고 즉시 실행 가능한 **Eager Excution** 이 적용되었다
사용자에게 제공되는 High Level API로써 **Keras** 만을 제공한다

## **Eager Excution**

* TS 1.x 버전은 세션을 만들어야 연산이 가능하지만 TS 2.0 버전은 numpy()함수를 이용하여 바로 더하기 연산을 수행하여 결과를 바로 보는게 가능하다

### **tf.constant()**

* 상수를 만들기 위해서 사용하는 함수

* TF 1.x에서 세션을 만들지 않고 덧셈 연산을 수행한다면 저장된 값이 아닌 현재 노드의 상태를 출력한다

### **tf.constant()**

* 변수 타입을 생성하는 것이 가능

* TF 1.x에서는 이러한 변수를 사용하려면 세션을 만들고 변수 초기화 코드가 실행되고 난 후에 변수에 값을 할당하거나 연산 가능

* TF 2.x 에서는 초기화 없이 위 행위가 가능하다


## **Keras**

특징

> User Friendliness(사용자 친화)

* Keras의 직관적인 API를 이용하면 일반 신경망, 컴벌루젼 신경망, 순환 신경망 등을 몇줄의 코드로 쉽게 구현이 가능하다

> Modularity

* 모듈을 독립적으로 설정해 신경망 층, 손실함수, 활성화 함수, 최적화 알고리즘 등을 조합시켜 새로운 딥러닝 모델을 쉽고 빠르게 만들어서 학습시키는게 가능하다



* Keras의 핵심적인 데이터 구조는 Model이다
    * 모델은 3층을 포함하는 인공신경망을 지칭 하는데 입력,은닉, 출력 각각의 층을 가진다

> 층을 추가해 신경망들을 조합해 다양한 모델을 구성이 가능하다

```Python
model = Sequential() # 모델 생성

model.add(...) #층 추가

model.compile(...) # 손실함수, 옵티마이저 지정

model.fit(...) # 손실함수가 최소값이 될 때까지 학습진행

model.evaluate(테스트 데이터, 정답데이터, 배치사이즈) # 모델 평가

model.predict(예측하고자 하는 데이터, 배치 사이즈) # 모델 예측

model.save(...) # 학습이 끝난 모델을 저장
```

|케라스 개발 과정|케라스 API|
|:-:|:-:|
|데이터 생성||
|모델 구축||
|모델 컴파일||
|모델 학습||
|모델 평가 및 예측||
|모델 저장||

## Keras 개발 과정

### 1. 데이터 생성

* 전체 데이터로부터 train data / validation data / test data 등을 생성함

    * ```train data``` : 학습에 사용되는 데이터이며, 가중치와 바이어스를 최적화 하기 위해 사용됨

    * ```validation data``` : 1 epoch 마다 현재의 손실함수값 을 확인하기 위해서 사용됨

    * ```test data``` : 학습 후에 정확도를 평가하거나 임의의 입력에 대한 결과를 예측하기 위해 사용되는 데이터임

### 2. 모델 구축

* Flatten는 입력으로 들어오는 다차원 데이터를 1차원으로 정렬하기 위해 사용되는 레이어이다

* Dense는 각층의 입력과 출력 사이에 있는 모든 노드가 서로 연결되어 있는 완전 연결 층을 나타낸다

    * 덴스의 첫번째인자는 출력 노드수를 나타낸다

* 노드의 활성화 함수는 ```activation='..'``` 형태로 나타낸다 일반적으로는 'sigmoid', 'softmax', 'relu', 'tanh'
선형회귀 문제에서는 'linear' 등이 데이터에 따라서 다양하게 사용됨

### 3. 모델 컴파일

* 구축된 모델을 컴파일 하고 알고리즘, 오차함수, 학습 과정중에 모니터링 할 지표를 나타낼 수 있음 

### 4. 모델 학습

* 손실 함수 값이 최소가 될 때까지 각 츠으이 가중치와 바이어스를 업데이트 하는 과정

    - epochs -> 반복횟수
    - batch_size -> 배치사이즈
    - validation_split -> 학습데이터의 n%를 검증데이터로 사용함
    - verbose -> 학습 중 손실 값, 정확도, 진행 상태 등의 출력 형태를 설정함 (0, 1, 2)
    
    > 검증 데이터가 따로 있다면 ```validation_data```를 이용하여 지정 가능함

### 5. 모델 평가

* 학습을 마친 후, test data를 통해서 모델을 평가하고 임의의 데이터에 대해 예측함

### 6. 모델 저장

* 학습이 끝난 신경망 구조를 저장해 놓는다면, 다양한 테스트 데이터에 대해 재 학습 없이 지속적으로 사용할 수 있음